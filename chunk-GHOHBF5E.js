var c=class{constructor(t){this.values=[],this.delimiter=":",this.hasValue(t)&&this.addValue(t)}toString(){return this.values.join(this.delimiter)}hasValue(t){return typeof t<"u"&&t!==null&&t!==""}addValue(t){return Array.isArray(t)?this.values=this.values.concat(t):this.values.push(t),this.values=this.values.filter(e=>this.hasValue(e)),this}setDelimiter(t){return this.delimiter=t,this}};var L=class extends Error{constructor(t="Unsupported"){super(t)}};function _(r){return new L(r)}function N(){return this._qualifierModel||{error:_(`unsupported qualifier ${this.constructor.name}`)}}var C=class{constructor(){this._qualifierModel={}}toJson(){return N.apply(this)}};var f=class extends C{constructor(t,e){super(),this.delimiter="_",this.key=t,e instanceof c?this.qualifierValue=e:(this.qualifierValue=new c,this.qualifierValue.addValue(e))}toString(){let{key:t,delimiter:e,qualifierValue:i}=this;return`${t}${e}${i.toString()}`}addValue(t){return this.qualifierValue.addValue(t),this}};var a=class extends f{constructor(t,e){let i;e?i=new c([t,`${e}`]).setDelimiter(":"):i=t,super("fl",i),this.flagValue=e}toString(){return super.toString().replace(/\./g,"%2E")}getFlagValue(){return this.flagValue}};function q(r,t){let e=Array.from(r.entries());return t.forEach(i=>{e.push(["fl",i])}),e.sort().map(i=>i[1])}function Q(){var r,t,e;let i=this._actionModel&&Object.keys(this._actionModel).length,n=(e=(t=(r=this._actionModel)===null||r===void 0?void 0:r.source)===null||t===void 0?void 0:t.transformation)===null||e===void 0?void 0:e.error;return n&&n instanceof Error?{error:n}:i?this._actionModel:{error:_(`unsupported action ${this.constructor.name}`)}}var v=class{constructor(){this._actionModel={}}toJson(){return Q.apply(this)}};var d=class extends v{constructor(){super(...arguments),this.qualifiers=new Map,this.flags=[],this.delimiter=",",this.actionTag=""}prepareQualifiers(){}getActionTag(){return this.actionTag}setActionTag(t){return this.actionTag=t,this}toString(){return this.prepareQualifiers(),q(this.qualifiers,this.flags).join(this.delimiter)}addQualifier(t){if(typeof t=="string"){let[e,i]=t.toLowerCase().split("_");e==="fl"?this.flags.push(new a(i)):this.qualifiers.set(e,new f(e,i))}else this.qualifiers.set(t.key,t);return this}addFlag(t){return typeof t=="string"?this.flags.push(new a(t)):t instanceof a&&this.flags.push(t),this}addValueToQualifier(t,e){return this.qualifiers.get(t).addValue(e),this}};function Y(r){return r&&(r.match(/^#/)?`rgb:${r.substr(1)}`:r)}var E=class extends d{constructor(t){super(),this._actionModel={},this.addQualifier(new f("b",new c(Y(t)).setDelimiter("_"))),this._actionModel.color=t,this._actionModel.actionType="backgroundColor"}static fromJson(t){let{color:e}=t;return new this(e)}};var O=class{constructor(t){this.raw=t}toString(){return this.raw}toJson(){return{error:_(`unsupported action ${this.constructor.name}`)}}};function z(r){let t=r;return"error"in t&&!!t.error}function nr(){return new a("ignore_aspect_ratio")}function H(){return new a("lossy")}function J(){return new a("preserve_transparency")}function K(r){return new a("progressive",r)}function or(){return new a("region_relative")}function sr(){return new a("relative")}var S=class extends c{constructor(t){super(t),this.val=t}getValue(){return this.val}};function h(r){let t={};return Object.keys(r).forEach(e=>{t[r[e]]=e}),t}var pt={limitFit:"limit",limitFill:"lfill",minimumFit:"mfit",thumbnail:"thumb",limitPad:"lpad",minimumPad:"mpad",autoPad:"auto_pad"},dt={colorSpace:"cs",dpr:"dpr",density:"dn",defaultImage:"d",format:"f",quality:"q"},ht={redEye:"redeye",advancedRedEye:"adv_redeye",oilPaint:"oil_paint",unsharpMask:"unsharp_mask",makeTransparent:"make_transparent",generativeRestore:"gen_restore",upscale:"upscale"},mt={autoBest:"auto:best",autoEco:"auto:eco",autoGood:"auto:good",autoLow:"auto:low",jpegminiHigh:"jpegmini:1",jpegminiMedium:"jpegmini:2",jpegminiBest:"jpegmini:0"},gt={fullHd:"full_hd",fullHdWifi:"full_hd_wifi",fullHdLean:"full_hd_lean",hdLean:"hd_lean"},_t={444:"CHROMA_444",420:"CHROMA_420"},yt={noCmyk:"no_cmyk",keepCmyk:"keep_cmyk",tinySrgb:"tinysrgb",srgbTrueColor:"srgb:truecolor"};var pr=h(_t),dr=h(yt),hr=h(pt),W=h(dt),mr=h(ht),gr=h(mt),_r=h(gt);var b=class extends d{constructor(t,e,i){super(),this._actionModel={};let n;e instanceof S?n=e.getValue():n=e,this._actionModel.actionType=W[t],this._actionModel[i]=n,this.addQualifier(new f(t,e))}};var M=class extends a{constructor(t){super("progressive",t)}};var m=class extends b{constructor(t,e){super(t,e,"formatType")}lossy(){return this._actionModel.lossy=!0,this.addFlag(H()),this}progressive(t){return t instanceof M?(this._actionModel.progressive={mode:t.getFlagValue()},this.addFlag(t)):(this._actionModel.progressive={mode:t},this.addFlag(K(t))),this}preserveTransparency(){return this._actionModel.preserveTransparency=!0,this.addFlag(J()),this}static fromJson(t){let{formatType:e,lossy:i,progressive:n,preserveTransparency:o}=t,s;return e?s=new this("f",e):s=new this("f"),n&&(n.mode?s.progressive(n.mode):s.progressive()),i&&s.lossy(),o&&s.preserveTransparency(),s}};var y=class r{constructor(){this.actions=[]}addAction(t){let e;if(typeof t=="string"){if(t.indexOf("/")>=0)throw"addAction cannot accept a string with a forward slash in it - /, use .addTransformation() instead";e=new O(t)}else e=t;return this.actions.push(e),this}addTransformation(t){return t instanceof r?this.actions=this.actions.concat(t.actions):this.actions.push(new O(t)),this}toString(){return this.actions.map(t=>t.toString()).filter(t=>t).join("/")}animated(t){return this.addAction(t)}border(t){return this.addAction(t)}reshape(t){return this.addAction(t)}resize(t){return this.addAction(t)}quality(t){return this.addAction(new m("q",t)),this}format(t){return this.addAction(new m("f",t)),this}roundCorners(t){return this.addAction(t)}overlay(t){return this.addAction(t)}underlay(t){return t.setLayerType("u"),this.addAction(t)}addVariable(t){return this.addAction(t)}conditional(t){return this.addAction(t)}effect(t){return this.addAction(t)}adjust(t){return this.addAction(t)}rotate(t){return this.addAction(t)}namedTransformation(t){return this.addAction(t)}delivery(t){return this.addAction(t)}backgroundColor(t){return this.addAction(new E(t))}psdTools(t){return this.addAction(t)}extract(t){return this.addAction(t)}addFlag(t){let e=new d,i=t;return typeof t=="string"&&(i=new a(t)),e.addQualifier(i),this.addAction(e)}customFunction(t){return this.addAction(t)}transcode(t){return this.addAction(t)}videoEdit(t){return this.addAction(t)}toJson(){let t=[];for(let e of this.actions){let i=e.toJson();if(z(i))return i;t.push(i)}return{actions:t}}};var P=class extends y{};function G(r){return r.match(/^https?:\//)}function B(r){return r.indexOf("/")<0}function X(r){return r.match(/^v[0-9]+/)}function Z(r,t){let e=t.secure,i=t.privateCdn,n=t.cname,o=t.secureDistribution;return!e&&!n?`http://res.cloudinary.com/${r}`:e&&!o&&i?`https://${r}-res.cloudinary.com`:e&&!o?`https://res.cloudinary.com/${r}`:e&&o&&i?`https://${o}`:e&&o?`https://${o}/${r}`:!e&&n?`http://${n}/${r}`:"ERROR"}function tt(r){return r||"image"}function rt(r){return r||"upload"}function et(r,t,e){let i=e!==!1;return t?`v${t}`:X(r)||G(r)||B(r)?"":i?"v1":""}function xt(r){return!(typeof r!="object"||r instanceof Array)}var I=class{filterOutNonSupportedKeys(t,e){let i=Object.create({});return xt(t)?(Object.keys(t).forEach(n=>{e.indexOf(n)>=0?i[n]=t[n]:console.warn("Warning - unsupported key provided to configuration: ",n)}),i):Object.create({})}},it=I;var U=["cname","secureDistribution","privateCdn","signUrl","longUrlSignature","shorten","useRootPath","secure","forceVersion","analytics","queryParams"];var k=class r extends it{constructor(t){super();let e=this.filterOutNonSupportedKeys(t,U);Object.assign(this,{secure:!0},e)}extend(t){let e=this.filterOutNonSupportedKeys(t,U);return new r(Object.assign({},this,e))}setCname(t){return this.cname=t,this}setSecureDistribution(t){return this.secureDistribution=t,this}setPrivateCdn(t){return this.privateCdn=t,this}setSignUrl(t){return this.signUrl=t,this}setLongUrlSignature(t){return this.longUrlSignature=t,this}setShorten(t){return this.shorten=t,this}setUseRootPath(t){return this.useRootPath=t,this}setSecure(t){return this.secure=t,this}setForceVersion(t){return this.forceVersion=t,this}setQueryParams(t){return this.queryParams=t,this}},nt=k;function x(r,t,e){let i=t>>0,n=String(typeof e<"u"?e:" ");return r.length>i?String(r):(i=i-r.length,i>n.length&&(n+=Tt(n,i/n.length)),n.slice(0,i)+String(r))}function Tt(r,t){let e=t,i="";for(;e>0;)i+=r,e--;return i}var wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T={},ot=0;wt.split("").forEach(r=>{let t=ot.toString(2);t=x(t,6,"0"),T[t]=r,ot++});function st(r){if(r.split(".").length<2)throw new Error("invalid semVer, must have at least two segments");return r.split(".").reverse().join(".")}function at(r){if(r.split(".").length<2)throw new Error("invalid semVer, must have at least two segments");return r.split(".").map(t=>{let e=+t;if(isNaN(e)||e<0)throw"Invalid version number provided";return x(t,2,"0")}).join(".")}function F(r){let t="",i=r.split(".").length*6,n=st(r),o=at(n),u=parseInt(o.split(".").join("")).toString(2);if(u=x(u,i,"0"),u.length%6!==0)throw"Version must be smaller than 43.21.26)";return u.match(/.{1,6}/g).forEach(l=>{t+=T[l]}),t}function ut(r){let t={sdkSemver:r.sdkSemver,techVersion:r.techVersion,sdkCode:r.sdkCode,product:r.product,feature:"0",osType:r.osType,osVersion:r.osVersion};return r.accessibility&&(t.feature="D"),r.lazyload&&(t.feature="C"),r.responsive&&(t.feature="A"),r.placeholder&&(t.feature="B"),t}var ct="1.21.0";function ft(r){let[t,e]=r.split("."),i=parseInt(t).toString(2),n=parseInt(e).toString(2),o=i.padStart(6,"0"),s=n.padStart(6,"0");return T[o]+T[s]}function At(){let r="0.0.0";if(typeof window<"u")return r;try{return process.versions.node||r}catch{return r}}function Ot(r){let t={techVersion:At(),sdkCode:"T",sdkSemver:ct.split("-")[0],product:"A",osType:"Z",osVersion:"0.0",responsive:!1,placeholder:!1,lazyload:!1,accessibility:!1};return r?Object.assign(Object.assign({},t),r):t}function j(r){let t=Ot(r),e=ut(t);try{let i=Ct(e.techVersion),n=F(e.sdkSemver),o=F(i),s=ft(e.osVersion),u=e.feature,l=e.sdkCode,{product:p,osType:g}=e;return`D${p}${l}${n}${o}${g}${s}${u}`}catch{return"E"}}function Ct(r){let t=r.split(".");return`${t[0]}.${t[1]}`}var lt={"image/upload":"images","image/private":"private_images","image/authenticated":"authenticated_images","raw/upload":"files","video/upload":"videos"},V=class{constructor(t,e={},i){this.setPublicID(t),this.setCloudConfig(e),this.setURLConfig(i)}setURLConfig(t){return this.urlConfig=new nt(t),this}setCloudConfig(t){return this.cloudName=t.cloudName,this.apiKey=t.apiKey,this.apiSecret=t.apiSecret,this.authToken=t.authToken,this}setPublicID(t){return this.publicID=t?t.toString():"",this}setDeliveryType(t){return this.deliveryType=t,this}setSuffix(t){return this.suffix=t,this}setSignature(t){return this.signature=t,this}setVersion(t){return t&&(this.version=t),this}setAssetType(t){return t&&(this.assetType=t),this}sign(){return this}toURL(t={}){return this.createCloudinaryURL(null,t.trackedAnalytics)}validateAssetForURLCreation(){if(typeof this.cloudName>"u")throw"You must supply a cloudName when initializing the asset";let t=this.suffix&&this.suffix.indexOf(".")>=0,e=this.suffix&&this.suffix.indexOf("/")>=0;if(t||e)throw"`suffix`` should not include . or /"}getResourceType(){let t=tt(this.assetType),e=rt(this.deliveryType),i=!!this.suffix,n=`${t}/${e}`,o=lt[`${t}/${e}`],s=this.urlConfig.useRootPath,u=this.urlConfig.shorten;if(s){if(n==="image/upload")return"";throw new Error(`useRootPath can only be used with assetType: 'image' and deliveryType: 'upload'. Provided: ${n} instead`)}if(u&&n==="image/upload")return"iu";if(i){if(o)return o;throw new Error(`URL Suffix only supported for ${Object.keys(lt).join(", ")}, Provided: ${n} instead`)}return n}getSignature(){return this.signature?`s--${this.signature}--`:""}createCloudinaryURL(t,e){if(!this.publicID)return"";this.validateAssetForURLCreation();let i=Z(this.cloudName,this.urlConfig),n=t?t.toString():"",o=et(this.publicID,this.version,this.urlConfig.forceVersion),s=this.publicID;if(typeof t=="string")return[i,this.getResourceType(),this.getSignature(),n,o,s.replace(/,/g,"%2C"),this.suffix].filter(l=>l).join("/");{let u=[encodeURI(i),this.getResourceType(),this.getSignature(),encodeURI(n),o,encodeURI(s).replace(/,/g,"%2C"),this.suffix&&encodeURI(this.suffix)].filter(g=>g).join("/").replace(/\?/g,"%3F").replace(/=/g,"%3D"),l=this.urlConfig.analytics!==!1&&!s.includes("?"),p="";if(typeof this.urlConfig.queryParams=="object")try{let g=new URLSearchParams(this.urlConfig.queryParams);l&&g.set("_a",j(e)),p=g.toString()}catch{console.error("Error: URLSearchParams is not available so the queryParams object cannot be parsed, please try passing as an already parsed string")}else p=this.urlConfig.queryParams||"",l&&(p+=`${p.length>0?"&":""}_a=${j(e)}`);return p?`${u}?${p}`:u}}};var w=class extends V{constructor(t,e,i,n){super(t,e,i),this.transformation=n}animated(t){return this.transformation.animated(t),this}border(t){return this.transformation.border(t),this}reshape(t){return this.transformation.reshape(t),this}resize(t){return this.transformation.resize(t),this}quality(t){return this.addAction(new m("q",t)),this}format(t){return this.addAction(new m("f",t)),this}roundCorners(t){return this.transformation.roundCorners(t),this}overlay(t){return this.transformation.overlay(t),this}addVariable(t){return this.transformation.addVariable(t),this}conditional(t){return this.transformation.conditional(t),this}effect(t){return this.transformation.effect(t),this}adjust(t){return this.transformation.adjust(t),this}rotate(t){return this.transformation.rotate(t),this}namedTransformation(t){return this.transformation.namedTransformation(t),this}delivery(t){return this.transformation.delivery(t),this}backgroundColor(t){return this.transformation.backgroundColor(t),this}psdTools(t){return this.transformation.psdTools(t),this}extract(t){return this.transformation.extract(t),this}addFlag(t){return this.transformation.addFlag(t),this}customFunction(t){return this.transformation.customFunction(t),this}addAction(t){return this.transformation.addAction(t),this}addTransformation(t){return this.transformation.addTransformation(t),this}toString(){return this.transformation.toString()}underlay(t){return this.transformation.underlay(t),this}toURL(t={}){return this.createCloudinaryURL(this.transformation,t?.trackedAnalytics)}};var R=class extends w{constructor(t,e,i){super(t,e,i,new P)}};var A=class extends y{};var D=class extends w{constructor(t,e,i){super(t,e,i,new A),this.assetType="video"}transcode(t){return this.transformation.transcode(t),this}videoEdit(t){return this.transformation.videoEdit(t),this}};var $=class{constructor(t){t&&(this.cloudinaryConfig=t)}image(t){return new R(t,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}video(t){return new D(t,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}setConfig(t){return this.cloudinaryConfig=t,this}getConfig(){return this.cloudinaryConfig}extendConfig(){}};export{c as a,f as b,a as c,d,nr as e,or as f,sr as g,pt as h,hr as i,$ as j};
