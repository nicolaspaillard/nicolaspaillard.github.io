import{a as m,c as y,d as a,e as k,f as c,h as u,j as w,k as x,l as h}from"./chunk-SEJLOZK4.js";import{a as _,b as l,ba as p,ga as b,h as r,q as f}from"./chunk-IGXIJTVN.js";var o=class{constructor(S){Object.assign(this,S)}},g=(()=>{class e{constructor(d){this.db=d,this.__sections=[],this._sections=new f(1),this.sections=()=>this._sections.asObservable(),this.moveSections=t=>{let s=t;this.__sections.slice(t).forEach(i=>{if(i.rank>s)return;this.__sections[this.__sections.indexOf(i)].rank++;let n=new o(l(_({},i),{rank:i.rank+1}));delete n.id,h(c(this.db,"data","sections","sections",i.id),Object.assign({},n))})},this.createSection=t=>r(this,null,function*(){try{this.moveSections(t.rank),t.id=(yield y(a(this.db,"data","sections","sections"),t)).id,this.__sections.push(t),this.__sections.sort((s,i)=>s.rank-i.rank),this._sections.next(this.__sections)}catch(s){console.error(s)}}),this.updateSection=t=>r(this,null,function*(){try{this.moveSections(t.rank);let s=new o(t);delete s.id,yield h(c(this.db,"data","sections","sections",t.id),Object.assign({},s)),this.__sections[this.__sections.findIndex(i=>i.id===t.id)]=t,this.__sections.sort((i,n)=>i.rank-n.rank),this._sections.next(this.__sections)}catch(s){console.error(s)}}),this.deleteSection=t=>r(this,null,function*(){try{yield k(c(this.db,"data","sections","sections",t.id)),this.__sections.splice(this.__sections.findIndex(s=>s.id===t.id),1),this._sections.next(this.__sections)}catch(s){console.error(s)}});try{u(x(a(this.db,"data","sections","sections"),w("rank"))).then(t=>{t.docs.forEach(s=>{let i=new o(s.data());i.id=s.id,this.__sections.push(i)})})}catch(t){console.error(t)}finally{this._sections.next(this.__sections)}}static{this.\u0275fac=function(t){return new(t||e)(b(m))}}static{this.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();export{o as a,g as b};
